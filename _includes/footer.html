<!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    {{- '©' }}
    <time>{{ 'now' | date: '%Y' }}</time>

    {% if site.social.links %}
      <a href="{{ site.social.links[0] }}">{{ site.social.name }}</a>.
    {% else %}
      <em class="fst-normal">{{ site.social.name }}</em>.
    {% endif %}

    {% if site.data.locales[include.lang].copyright.brief %}
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="{{ site.data.locales[include.lang].copyright.verbose }}"
      >
        {{- site.data.locales[include.lang].copyright.brief -}}
      </span>
    {% endif %}
  </p>

  <p>
    {%- capture _platform -%}
      <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
    {%- endcapture -%}

    {%- capture _theme -%}
      <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v{{ theme.version }}"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a>
    {%- endcapture -%}

    {{ site.data.locales[include.lang].meta | replace: ':PLATFORM', _platform | replace: ':THEME', _theme }}
  </p>

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <!-- 방문자 수 표시 -->
  <div class="visitor-count">
  <span id="busuanzi_container_site_pv">
    Total visits: <span id="busuanzi_value_site_pv"></span>
  </span>
  <span id="busuanzi_container_site_uv">
    Unique visitors: <span id="busuanzi_value_site_uv"></span>
  </span>
</div>
</footer>

<!-- 방문자 수 카운터 스크립트 (CountAPI 사용: 브라우저당 1회만 증가) -->
<script>
  (async () => {
    const namespace = 'mkangsh-github-io'; // 사이트 고유 네임스페이스로 변경 가능
    const key = 'site-visitors';           // 전체 사이트용 키
    const el = document.getElementById('visitor-count');
    if (!el) return;

    try {
      const visitedKey = 'site-visited-once';
      const endpoint = localStorage.getItem(visitedKey)
        ? `https://api.countapi.xyz/get/${namespace}/${key}`
        : `https://api.countapi.xyz/hit/${namespace}/${key}`;

      const res = await fetch(endpoint);
      const data = await res.json();
      el.textContent = Number(data.value).toLocaleString();

      if (!localStorage.getItem(visitedKey)) {
        localStorage.setItem(visitedKey, '1');
      }
    } catch (e) {
      console.error('Visitor counter error:', e);
    }
  })();
</script>
